<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v0.14.0/mapbox-gl-draw.css' type='text/css' />
<script src="<%= javascript_path('bundle.js') %>"></script>
<div class="spinner-container spinner"></div>
<div id="panel">
  <div class="panel-header o-grid__cell o-grid__cell--width-100">
    <h3 class="c-heading"><%= @city.name %><a class="c-link back-edit-city-link" href="/<%= @city.url_name %>"><span class="fa fa-arrow-circle-o-left"></span></a></h3>
  </div>
  <div class="panel-body">
    <div class="editor-cards-container">
      <div class="c-card">
        <div class="c-card__item">
          <b><p id="feature-header" class="c-paragraph">Ningún elemento seleccionado</p></b>
          <p id="feature-properties" class="c-paragraph"></p>
        </div>
      </div>
      <div class="c-card">
        <div class="c-card__item">
          <b><p id="modifications-header" class="c-paragraph">Ningún elemento modificado</p></b>
          <p id="modifications" class="c-paragraph"></p>
        </div>
      </div>
    </div>
  </div>
</div>
<main class="o-grid__cell o-grid__cell--width-100 o-panel-container">
  <div id="map"></div>
</main>

<script>
  window.onload = function() {
    var config = <%= @config.to_json %>;
    var mapboxAccessToken = <%= MAPBOX_ACCESS_TOKEN.to_json %>;
    var mapboxStyle = <%= MAPBOX_STYLE.to_json %>;

    var sections = <%= lines_features_collection(@city, 'sections').to_json %>;
    var stations = <%= lines_features_collection(@city, 'stations').to_json %>;

    loadEditor(sections, stations, config, mapboxAccessToken, mapboxStyle);
  }
</script>
